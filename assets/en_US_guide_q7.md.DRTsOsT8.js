import{_ as e,c as i,o as t,a4 as s}from"./chunks/framework.BmdFiWrL.js";const m=JSON.parse('{"title":"Customizing Agent Monitoring Items","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en_US/guide/q7.md","filePath":"en_US/guide/q7.md","lastUpdated":1733609010000}'),o={name:"en_US/guide/q7.md"},n=s('<h1 id="customizing-agent-monitoring-items" tabindex="-1">Customizing Agent Monitoring Items <a class="header-anchor" href="#customizing-agent-monitoring-items" aria-label="Permalink to &quot;Customizing Agent Monitoring Items&quot;">​</a></h1><p>The Agent&#39;s functionality and behavior can be tailored to specific monitoring needs by configuring its runtime parameters.</p><hr><h2 id="runtime-parameters" tabindex="-1">Runtime Parameters <a class="header-anchor" href="#runtime-parameters" aria-label="Permalink to &quot;Runtime Parameters&quot;">​</a></h2><h3 id="configuration-parameters" tabindex="-1">Configuration Parameters <a class="header-anchor" href="#configuration-parameters" aria-label="Permalink to &quot;Configuration Parameters&quot;">​</a></h3><p>If you installed the Agent using the one-click script, you can edit the <code>/opt/nezha/agent/config.yml</code> file to add or modify parameters.<br> Multiple Agents can run on the same server, and each Agent&#39;s configuration file is independent.</p><p>Below is a list of runtime parameters and their functions:</p><ul><li><p><strong><code>client_secret:</code></strong></p><ul><li>The client secret used for secure communication with the Dashboard.</li><li>This parameter must match the configuration in the Dashboard to enable proper communication.</li></ul></li><li><p><strong><code>debug:</code></strong></p><ul><li>When set to <code>true</code>, enables debug mode and logs detailed information.</li></ul></li><li><p><strong><code>disable_auto_update:</code></strong></p><ul><li>When set to <code>true</code>, disables the automatic update feature, enhancing system stability and security.</li></ul></li><li><p><strong><code>disable_command_execute:</code></strong></p><ul><li>When set to <code>true</code>, disables the execution of online terminals, file management, and scheduled tasks for increased security.</li></ul></li><li><p><strong><code>disable_force_update:</code></strong></p><ul><li>When set to <code>true</code>, disables forced updates, allowing only manual updates.</li></ul></li><li><p><strong><code>disable_nat:</code></strong></p><ul><li>When set to <code>true</code>, disables the NAT traversal feature to protect internal network data.</li></ul></li><li><p><strong><code>disable_send_query:</code></strong></p><ul><li>When set to <code>true</code>, prevents the Agent from initiating <code>TCP Ping</code>, <code>ICMP Ping</code>, and <code>HTTP GET</code> requests.</li></ul></li><li><p><strong><code>gpu:</code></strong></p><ul><li>When set to <code>true</code>, enables GPU monitoring.</li><li>Note: Additional dependencies may be required for GPU monitoring. See the <a href="/en_US/guide/q9.html">GPU Monitoring Guide</a> for details.</li></ul></li><li><p><strong><code>insecure_tls:</code></strong></p><ul><li>When set to <code>true</code>, disables certificate validation, suitable for scenarios using self-signed certificates.</li></ul></li><li><p><strong><code>ip_report_period:</code></strong></p><ul><li>Sets the interval (in seconds) for local IP updates. The default is <code>1800</code> seconds (30 minutes).</li><li>If this value is less than the <code>report_delay</code> setting, the <code>report_delay</code> value will take precedence.</li></ul></li><li><p><strong><code>report_delay:</code></strong></p><ul><li>Sets the interval (in seconds) for system information reporting. The default is <code>1</code> second. To reduce resource usage, a value of <code>3</code> seconds is recommended (valid range: 1-4 seconds).</li></ul></li><li><p><strong><code>server:</code></strong></p><ul><li>The domain or IP address of the Dashboard for communication, including the port number.</li></ul></li><li><p><strong><code>skip_connection_count:</code></strong></p><ul><li>When set to <code>true</code>, disables monitoring of network connection counts, suitable for servers with high connection volumes or limited resources.</li></ul></li><li><p><strong><code>skip_procs_count:</code></strong></p><ul><li>When set to <code>true</code>, disables monitoring of process counts to lower resource usage.</li></ul></li><li><p><strong><code>temperature:</code></strong></p><ul><li>When set to <code>true</code>, enables hardware temperature monitoring (only supported for specific hardware; unavailable for some VPS instances).</li></ul></li><li><p><strong><code>tls:</code></strong></p><ul><li>When set to <code>true</code>, enables SSL/TLS encryption for communication between the Agent and the Dashboard.</li><li>Enable this option if the Agent uses an SSL/TLS-enabled Nginx reverse proxy.</li></ul></li><li><p><strong><code>hard_drive_partition_allowlist:</code></strong></p><ul><li>A string array specifying the list of hard drive partitions to monitor.</li><li>Monitoring will only include the listed partitions.</li></ul></li><li><p><strong><code>nic_allowlist:</code></strong></p><ul><li>A <code>map[string]bool</code> type whitelist specifying the network interfaces to monitor.</li><li>The key is the network interface name, and the value is <code>true</code> for monitoring and <code>false</code> for exclusion.</li><li>If not specified, all available interfaces are monitored by default.</li></ul></li><li><p><strong><code>use_gitee_to_upgrade:</code></strong></p><ul><li>When set to <code>true</code>, uses the Gitee repository as the automatic update source, better suited for servers in mainland China.</li></ul></li><li><p><strong><code>use_ipv6_country_code:</code></strong></p><ul><li>When set to <code>true</code>, forces the use of IPv6 addresses for country code queries (default uses IPv4).</li></ul></li><li><p><strong><code>uuid:</code></strong></p><ul><li>The unique identifier for the current Agent, used by the Dashboard to recognize the data source.</li><li>To replace an existing Agent in the Dashboard, manually set this parameter.</li></ul></li><li><p><strong><code>dns:</code></strong></p><ul><li>A string array to set custom DNS server lists.</li><li>When specified, the Agent will prioritize these DNS servers for domain resolution.</li></ul></li><li><p><strong><code>custom_ip_api:</code></strong></p><ul><li>A string array specifying custom IP query API endpoints.</li><li>The Agent will use these APIs to retrieve the server&#39;s public IP information.</li></ul></li></ul><hr><h2 id="apply-changes" tabindex="-1">Apply Changes <a class="header-anchor" href="#apply-changes" aria-label="Permalink to &quot;Apply Changes&quot;">​</a></h2><p>After modifying the configuration file, restart the Agent service to apply changes. Follow these steps:</p><ol><li><p><strong>Restart the Service</strong><br> Use the following command to restart the default Agent service:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent.service</span></span></code></pre></div></li><li><p><strong>For Multiple Agent Services</strong><br> If running multiple Agent services on the same server, first list all Agent services:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list-units</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --type=service</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><p>Then restart each Agent service using the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">service-nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p>Replace <code>&lt;service-name&gt;</code> with the actual service name, such as <code>nezha-agent@2.service</code>.</p></li></ol>',12),a=[n];function l(r,d,c,p,u,h){return t(),i("div",null,a)}const f=e(o,[["render",l]]);export{m as __pageData,f as default};
